<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML><HEAD><TITLE>8.4 Photos</TITLE><LINK href="ozdoc.css" rel="stylesheet" type="text/css"></HEAD><BODY><TABLE align="center" border="0" cellpadding="6" cellspacing="6" class="nav"><TR bgcolor="#DDDDDD"><TD><A href="node37.html#misc.bitmap">&lt;&lt; Prev</A></TD><TD><A href="node34.html">- Up -</A></TD><TD><A href="node39.html#misc.imagelibrary">Next &gt;&gt;</A></TD></TR></TABLE><DIV id="misc.image"><H2><A name="misc.image">8.4 Photos</A></H2><P></P><H3><A name="label174">8.4.1 Description</A></H3><P>A photo is an image whose pixels can display any color or be transparent. A photo image is stored internally in full color (24 bits per pixel), and is displayed using dithering if necessary. Image data for a photo image can be obtained from a file, a string or a url. At present, only GIF and PPM/PGM formats are supported. A photo image is transparent in regions where no image data has been supplied.</P><P>In QTk, photos are built by the <CODE>QTk<SPAN class="keyword">.</SPAN>newImage</CODE> function. This function takes one parameter: a record of the form <CODE>photo(param1:value1&nbsp;<SPAN class="keyword">...</SPAN>&nbsp;paramX:valueX)</CODE> and returns an object allowing to reference that photo and change it as needed. The valid parameters and methods are described below.</P><H3><A name="label175">8.4.2 Parameters</A></H3><P></P><UL><LI><P><CODE>channel:C</CODE>: <CODE>C</CODE> gives the name of a channel open for reading which is to be read to supply data for the photo image. The data format in the channel must be one of those for which there is an image format handler that can read data from a file or channel. </P></LI><LI><P><CODE>data:VS</CODE>: Specifies the contents of the image as a string. The format of the string must be one of those for which there is an image file format handler that will accept string data. </P></LI><LI><P><CODE>url:VS</CODE>: <CODE>VS</CODE> gives the url of a file that is to be read to supply data for the photo image. The file format must be one of those for which there is an image file format handler that can read data from a file or channel. </P></LI><LI><P><CODE>format:VS</CODE>: Specifies the name of the file format for the data specified with the <CODE>data</CODE>, <CODE>url</CODE> or <CODE>file</CODE> option. </P></LI><LI><P><CODE>file:VS</CODE>: <CODE>VS</CODE> gives the name of a file that is to be read to supply data for the photo image. The file format must be one of those for which there is an image file format handler that can read data from a file or channel. </P></LI><LI><P><CODE>gamme:F</CODE>: Specifies that the colors allocated for displaying this image in a window should be corrected for a non-linear display with the specified gamma exponent value. (The intensity produced by most CRT displays is a power function of the input value, to a good approximation; gamma is the exponent and is typically around 2). The value specified must be greater than zero. The default value is one (no correction). In general, values greater than one will make the image lighter, and values less than one will make it darker. <CODE>F</CODE> must be a float. </P></LI><LI><P><CODE>height:I</CODE>: Specifies the height of the image, in pixels. This option is useful primarily in situations where the user wishes to build up the contents of the image piece by piece. A value of zero (the default) allows the image to expand or shrink vertically to fit the data stored in it. <CODE>I</CODE> must be non-negative integer. </P></LI><LI><P><CODE>palette:VS</CODE>: Specifies the resolution of the color cube to be allocated for displaying this image, and thus the number of colors used from the colormaps of the windows where it is displayed. The <CODE>VS</CODE> string may be either a string containing a single decimal number, specifying the number of shades of gray to use, or a string containing three decimal numbers separated by slashes (/), specifying the number of shades of red, green and blue to use, respectively. If the first form (a single number) is used, the image will be displayed in monochrome (i.e., grayscale). </P></LI><LI><P><CODE>width:I</CODE>: Specifies the width of the image, in pixels. This option is useful primarily in situations where the user wishes to build up the contents of the image piece by piece. A value of zero (the default) allows the image to expand or shrink horizontally to fit the data stored in it. <CODE>I</CODE> must be non-negative integer. </P></LI></UL><P> </P><H3><A name="label176">8.4.3 Interface</A></H3><P></P><UL><LI><P><CODE>set(parameter1:value1&nbsp;<SPAN class="keyword">...</SPAN>&nbsp;parameterX:valueX)</CODE>: Changes the value of one or more parameters. <CODE>parameterX</CODE> must be a valid parameter for the widget. <CODE>valueX</CODE> must be a valid value for the parameter.</P></LI><LI><P><CODE>get(parameter1:Variable1&nbsp;<SPAN class="keyword">...</SPAN>&nbsp;parameterX:VariableX)</CODE>: Obtains the value of one or more parameters. <CODE>parameterX</CODE> must be a valid parameter for the widget. <CODE>VariableX</CODE> must be free variables that will receive the current value of the parameters. </P></LI><LI><P><CODE>blank()</CODE>: Blank the image; that is, set the entire image to have no data, so it will be displayed as transparent, and the background of whatever window it is displayed in will show through. </P></LI><LI><P><CODE>copy(I&nbsp;param1:value1&nbsp;<SPAN class="keyword">...</SPAN>&nbsp;paramX:valueX)</CODE>: Copies a region from the image <CODE>I</CODE> (which must be a photo image) to this image, possibly with pixel zooming and/or subsampling. If no options are specified, this command copies the whole of <CODE>I</CODE> into this image, starting at coordinates (0,0) in this image. The following options may be specified: </P><UL><LI><P><CODE><SPAN class="keyword">from</SPAN>:R</CODE>: Specifies a rectangular sub-region of the source image to be copied. <CODE>R</CODE> must be a record of the form: <CODE>o(X1&nbsp;Y1&nbsp;X2&nbsp;Y2)</CODE>, where (X1,Y1) and (X2,Y2) specify diagonally opposite corners of the rectangle. If <CODE>X2</CODE> and <CODE>Y2</CODE> are not specified, the default value is the bottom-right corner of the source image. The pixels copied will include the left and top edges of the specified rectangle but not the bottom or right edges. If the <CODE><SPAN class="keyword">from</SPAN></CODE> option is not given, the default is the whole source image. </P></LI><LI><P><CODE>to:R)</CODE>: Specifies a rectangular sub-region of the destination image to be affected. <CODE>R</CODE> must be a record of the form: <CODE>o(X1&nbsp;Y1&nbsp;X2&nbsp;Y2)</CODE>, where (X1,Y1) and (X2,Y2) specify diagonally opposite corners of the rectangle. If <CODE>X2</CODE> and <CODE>Y2</CODE> are not specified, the default value is (X1,Y1) plus the size of the source region (after subsampling and zooming, if specified). If <CODE>X2</CODE> and <CODE>Y2</CODE> are specified, the source region will be replicated if necessary to fill the destination region in a tiled fashion. </P></LI><LI><P><CODE><SPAN class="string">&quot;-shrink&quot;</SPAN></CODE>: Specifies that the size of the destination image should be reduced, if necessary, so that the region being copied into is at the bottom-right corner of the image. This option will not affect the width or height of the image if the user has specified a non-zero value for the <CODE>width</CODE> or <CODE>height</CODE> configuration option, respectively. </P></LI><LI><P><CODE>zoom:R</CODE>: Specifies that the source region should be magnified by a factor. <CODE>R</CODE> must be a record of the form: <CODE>o(X&nbsp;Y)</CODE> where <CODE>X</CODE> is the factor in the X direction and <CODE>Y</CODE> the one in the Y direction. If <CODE>Y</CODE> is not given, the default value is the same as <CODE>X</CODE>. With this option, each pixel in the source image will be expanded into a block of <CODE>X</CODE> x <CODE>Y</CODE> pixels in the destination image, all the same color. <CODE>X</CODE> and <CODE>Y</CODE> must be greater than 0. </P></LI><LI><P><CODE>subsample:R</CODE>: Specifies that the source image should be reduced in size. <CODE>R</CODE> must be a record of the form <CODE>o(X&nbsp;Y)</CODE> where only <CODE>X</CODE>th pixel are kept in the X direction and only <CODE>Y</CODE>th pixel in the Y direction. Negative values will cause the image to be flipped about the Y or X axes, respectively. If <CODE>Y</CODE> is not given, the default value is the same as <CODE>X</CODE>. </P></LI></UL><P> </P></LI><LI><P><CODE>getColor(X&nbsp;Y&nbsp;V)</CODE>: Binds <CODE>V</CODE> to the color of the pixel at coordinates (X,Y) in the image as a list of three integers between 0 and 255, representing the red, green and blue components respectively. </P></LI><LI><P><CODE>put(LR&nbsp;to:R)</CODE>: Sets pixels in the photo to the colors specified in <CODE>LR</CODE>. <CODE>LR</CODE> is used to form a two-dimensional array of pixels that are copied into the photo. <CODE>LR</CODE> is a record of the form: </P><BLOCKQUOTE class="code"><CODE>q(q(P11&nbsp;P21&nbsp;<SPAN class="keyword">...</SPAN>&nbsp;Px1)<BR>&nbsp;&nbsp;q(P12&nbsp;P22&nbsp;<SPAN class="keyword">...</SPAN>&nbsp;Px2)<BR>&nbsp;&nbsp;<SPAN class="keyword">...</SPAN>&nbsp;<BR>&nbsp;&nbsp;q(P1y&nbsp;P2y&nbsp;<SPAN class="keyword">...</SPAN>&nbsp;Pxy))</CODE></BLOCKQUOTE><P> Where all <CODE>Pij</CODE> are valid colors (see <A href="node36.html#misc.color">Section&nbsp;8.2</A>). The <CODE>to</CODE> option can be used to specify the area of the photo to be affected. <CODE>R</CODE> must be a record of the corm <CODE>o(X1&nbsp;Y1&nbsp;X2&nbsp;Y2)</CODE>. If only <CODE>X1</CODE> and <CODE>Y1</CODE> are given, the area affected has its top-left corner at (X1,Y1) and is the same size as the array given in data. If all four coordinates are given, they specify diagonally opposite corners of the affected rectangle, and the array given in data will be replicated as necessary in the X and Y directions to fill the rectangle. </P></LI><LI><P><CODE>read(VS&nbsp;param1:value1&nbsp;<SPAN class="keyword">...</SPAN>&nbsp;paramX:valueX)</CODE>: Reads image data from the file named <CODE>VS</CODE> into the image. This command first searches the list of image file format handlers for a handler that can interpret the data in <CODE>VS</CODE>, and then reads the image in <CODE>VS</CODE> into the photo. The following options may be specified: </P><UL><LI><P><CODE>format:VS</CODE>: Specifies the format of the image data in filename. Specifically, only image file format handlers whose names begin with format-name will be used while searching for an image data format handler to read the data. </P></LI><LI><P><CODE><SPAN class="keyword">from</SPAN>:R</CODE>: Specifies a rectangular sub-region of the source image to be copied. <CODE>R</CODE> must be a record of the form: <CODE>o(X1&nbsp;Y1&nbsp;X2&nbsp;Y2)</CODE>, where (X1,Y1) and (X2,Y2) specify diagonally opposite corners of the rectangle. If <CODE>X2</CODE> and <CODE>Y2</CODE> are not specified, the default value is the bottom-right corner of the source image. The pixels copied will include the left and top edges of the specified rectangle but not the bottom or right edges. If the <CODE><SPAN class="keyword">from</SPAN></CODE> option is not given, the default is the whole source image. </P></LI><LI><P><CODE><SPAN class="string">&quot;-shrink&quot;</SPAN></CODE>: Specifies that the size of the destination image should be reduced, if necessary, so that the region being copied into is at the bottom-right corner of the image. This option will not affect the width or height of the image if the user has specified a non-zero value for the <CODE>width</CODE> or <CODE>height</CODE> configuration option, respectively. -to x y Specifies the coordinates of the top-left corner of the region of imageName into which data from filename are to be read. The default is (0,0). </P></LI><LI><P><CODE>to:R)</CODE>: Specifies a rectangular sub-region of the destination image to be affected. <CODE>R</CODE> must be a record of the form: <CODE>o(X1&nbsp;Y1&nbsp;X2&nbsp;Y2)</CODE>, where (X1,Y1) and (X2,Y2) specify diagonally opposite corners of the rectangle. If <CODE>X2</CODE> and <CODE>Y2</CODE> are not specified, the default value is (X1,Y1) plus the size of the source region (after subsampling and zooming, if specified). If <CODE>X2</CODE> and <CODE>Y2</CODE> are specified, the source region will be replicated if necessary to fill the destination region in a tiled fashion. </P></LI></UL><P> </P></LI><LI><P><CODE>redither()</CODE>: The dithering algorithm used in displaying photo images propagates quantization errors from one pixel to its neighbors. If the image data is supplied in pieces, the dithered image may not be exactly correct. Normally the difference is not noticeable, but if it is a problem, this command can be used to recalculate the dithered image in each window where the image is displayed. </P></LI><LI><P><CODE>write(VS&nbsp;param1:value1&nbsp;<SPAN class="keyword">...</SPAN>&nbsp;paramX:valueX)</CODE>: Writes image data to a file named <CODE>VS</CODE>. The following options may be specified: </P><UL><LI><P><CODE>format:VS</CODE>: Specifies the name of the image file format handler to be used to write the data to the file. Specifically, this subcommand searches for the first handler whose name matches a initial substring of format-name and which has the capability to write an image file. If this option is not given, the first handler that has the capability to write an image file is used. </P></LI><LI><P><CODE><SPAN class="keyword">from</SPAN>:R</CODE>: Specifies a rectangular region of the image to be written to the image file. <CODE>R</CODE> must be a record of the form <CODE>o(X1&nbsp;Y1&nbsp;X2&nbsp;Y2)</CODE>. If only <CODE>X1</CODE> and <CODE>Y1</CODE> are specified, the region extends from (X1,Y1) to the bottom-right corner of the photo. If all four coordinates are given, they specify diagonally opposite corners of the rectangular region. The default, if this option is not given, is the whole image. </P></LI></UL><P> </P></LI></UL><P> </P></DIV><TABLE align="center" border="0" cellpadding="6" cellspacing="6" class="nav"><TR bgcolor="#DDDDDD"><TD><A href="node37.html#misc.bitmap">&lt;&lt; Prev</A></TD><TD><A href="node34.html">- Up -</A></TD><TD><A href="node39.html#misc.imagelibrary">Next &gt;&gt;</A></TD></TR></TABLE><HR><ADDRESS>Donatien Grolaux<BR><SPAN class="version">Version 1.3.0 (20040413)</SPAN></ADDRESS></BODY></HTML>
