<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML><HEAD><TITLE>2.3 QHTML Manual : Events.</TITLE><LINK href="ozdoc.css" rel="stylesheet" type="text/css"></HEAD><BODY><TABLE align="center" border="0" cellpadding="6" cellspacing="6" class="nav"><TR bgcolor="#DDDDDD"><TD><A href="node5.html#chapter.handle">&lt;&lt; Prev</A></TD><TD><A href="index.html">- Up -</A></TD><TD><A href="node7.html#chapter.browser">Next &gt;&gt;</A></TD></TR></TABLE><DIV id="chapter.events"><H2><A name="chapter.events">2.3 QHTML Manual : Events.</A></H2><P>So far we are still unable to dynamically interact with the user, as we don't now what he is doing. Actions can be associated to user events. Many widgets have a main event that corresponding to the most obvious use of the widget. All other events can be finely defined using the bind method. </P><P></P><P></P><H3><A name="label7">2.3.1 Main events</A></H3><P></P><P>Most widgets raises an event just after the user has interacted with them : </P><P></P><UL><LI><P>After the user clicked on a button</P><P></P></LI><LI><P>After the user selected an item in a list</P><P></P></LI><LI><P>After the user typed a letter in an entry</P><P></P></LI><LI><P>After the user checked or unchecked a checkbutton</P><P></P></LI><LI><P>And so on depending on the widget type</P><P></P></LI></UL><P>These are called main events. Most common needs are covered by these events. These events are defined by the <CODE>action</CODE> parameter of the object. This parameter can be one of the following : </P><P></P><UL><LI><P>A zero parameter Oz procedure</P><P></P></LI><LI><P>A pair <CODE>objet_variable<SPAN class="keyword">#</SPAN>method</CODE></P><P></P></LI><LI><P>A pair <CODE>port_variable<SPAN class="keyword">#</SPAN>message</CODE></P><P></P></LI><LI><P>A pair <CODE>toplevel<SPAN class="keyword">#</SPAN>method</CODE></P><P></P></LI><LI><P>A pair <CODE>widget<SPAN class="keyword">#</SPAN>method</CODE></P><P></P></LI></UL><P>Where the last two are just shortcuts to <CODE>objet_variable<SPAN class="keyword">#</SPAN>method</CODE> with <CODE>objet_variable</CODE> being a reference respectively to the toplevel window or the handle of the widget itself. </P><P></P><BLOCKQUOTE class="code"><CODE><SPAN class="keyword">local</SPAN>&nbsp;&nbsp;<BR>&nbsp;&nbsp;<BR>&nbsp;&nbsp;<SPAN class="keyword">class</SPAN>&nbsp;<SPAN class="type">C</SPAN>&nbsp;&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;<SPAN class="keyword">meth</SPAN>&nbsp;<SPAN class="functionname">init</SPAN>&nbsp;<SPAN class="keyword">skip</SPAN>&nbsp;<SPAN class="keyword">end</SPAN>&nbsp;&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;<SPAN class="keyword">meth</SPAN>&nbsp;<SPAN class="functionname">show</SPAN>(Msg)&nbsp;{Show&nbsp;Msg}&nbsp;<SPAN class="keyword">end</SPAN>&nbsp;&nbsp;<BR>&nbsp;&nbsp;<SPAN class="keyword">end</SPAN>&nbsp;&nbsp;<BR>&nbsp;&nbsp;O={New&nbsp;C&nbsp;init}<BR>&nbsp;&nbsp;<BR>&nbsp;&nbsp;R<BR>&nbsp;&nbsp;P={NewPort&nbsp;R}<BR>&nbsp;&nbsp;<SPAN class="keyword">thread</SPAN>&nbsp;&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;{ForAll&nbsp;R&nbsp;<SPAN class="keyword">proc</SPAN>{<SPAN class="functionname">$</SPAN>&nbsp;Msg}&nbsp;{Show&nbsp;Msg}&nbsp;<SPAN class="keyword">end</SPAN>}<BR>&nbsp;&nbsp;<SPAN class="keyword">end</SPAN>&nbsp;&nbsp;<BR>&nbsp;&nbsp;<BR>&nbsp;&nbsp;Window={QHTML<SPAN class="keyword">.</SPAN>build&nbsp;toplevel(td(button(value:<SPAN class="string">&quot;Procedure&quot;</SPAN>&nbsp;&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;action:<SPAN class="keyword">proc</SPAN>{<SPAN class="functionname">$</SPAN>}&nbsp;{Show&nbsp;<SPAN class="string">'Procedure'</SPAN>}&nbsp;<SPAN class="keyword">end</SPAN>)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;button(value:<SPAN class="string">&quot;Object&quot;</SPAN>&nbsp;&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;action:O<SPAN class="keyword">#</SPAN>show(<SPAN class="string">'Object'</SPAN>))<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;button(value:<SPAN class="string">&quot;Port&quot;</SPAN>&nbsp;&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;action:P<SPAN class="keyword">#</SPAN><SPAN class="string">'Port'</SPAN>)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;button(value:<SPAN class="string">&quot;toplevel&quot;</SPAN>&nbsp;&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;action:toplevel<SPAN class="keyword">#</SPAN>set(title:<SPAN class="string">&quot;Toplevel&quot;</SPAN>))<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;button(value:<SPAN class="string">&quot;widget&quot;</SPAN>&nbsp;&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;action:widget<SPAN class="keyword">#</SPAN>set(value:<SPAN class="string">&quot;widget&nbsp;clicked&quot;</SPAN>))))}<BR><SPAN class="keyword">in</SPAN>&nbsp;&nbsp;<BR>&nbsp;&nbsp;{Window&nbsp;show}<BR><SPAN class="keyword">end</SPAN></CODE></BLOCKQUOTE><P></P><P>As you can see the <CODE>toplevel<SPAN class="keyword">#...</SPAN></CODE> and <CODE>widget<SPAN class="keyword">#...</SPAN></CODE> are just shortcuts. A frequent use is <CODE>button(value:<SPAN class="string">&quot;Close&quot;</SPAN>&nbsp;action:toplevel<SPAN class="keyword">#</SPAN>close)</CODE>.</P><P></P><P></P><H3><A name="label8">2.3.2 Concurrency between actions</A></H3><P></P><P>A unique thread is associated to each window : all actions are serialized and executed in the first in first out order. If the window is closed, pending actions are simply ignored. </P><P></P><BLOCKQUOTE class="code"><CODE><SPAN class="keyword">local</SPAN>&nbsp;&nbsp;<BR>&nbsp;&nbsp;Window={QHTML<SPAN class="keyword">.</SPAN>build&nbsp;toplevel(td(button(value:<SPAN class="string">&quot;1&quot;</SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;action:<SPAN class="keyword">proc</SPAN>{<SPAN class="functionname">$</SPAN>}&nbsp;{Delay&nbsp;2000}&nbsp;{Show&nbsp;1}&nbsp;<SPAN class="keyword">end</SPAN>)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;button(value:<SPAN class="string">&quot;2&quot;</SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;action:<SPAN class="keyword">proc</SPAN>{<SPAN class="functionname">$</SPAN>}&nbsp;{Delay&nbsp;2000}&nbsp;{Show&nbsp;2}&nbsp;<SPAN class="keyword">end</SPAN>)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;button(value:<SPAN class="string">&quot;close&quot;</SPAN>&nbsp;action:toplevel<SPAN class="keyword">#</SPAN>close))}<BR><SPAN class="keyword">in</SPAN>&nbsp;&nbsp;<BR>&nbsp;&nbsp;{Window&nbsp;show}<BR><SPAN class="keyword">end</SPAN></CODE></BLOCKQUOTE><P></P><P>See specific widget documentations for further details.</P><P></P><P></P><H3><A name="label9">2.3.3 Other events</A></H3><P></P><P>There are many other events that you might want to observe. Widgets have the <CODE>bind</CODE> method that allows you to add actions to all these events.</P><P></P><BLOCKQUOTE class="code"><CODE><SPAN class="keyword">local</SPAN>&nbsp;<BR>&nbsp;&nbsp;L&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<BR>&nbsp;&nbsp;Window={QHTML<SPAN class="keyword">.</SPAN>build&nbsp;toplevel(label(value:<SPAN class="string">&quot;Click&nbsp;me&nbsp;!&quot;</SPAN>&nbsp;handle:L))}<BR><SPAN class="keyword">in</SPAN>&nbsp;&nbsp;<BR>&nbsp;&nbsp;{Window&nbsp;show}<BR>&nbsp;&nbsp;{C&nbsp;bind(event:onclick<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;args:[x&nbsp;y]<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;action:<SPAN class="keyword">proc</SPAN>{<SPAN class="functionname">$</SPAN>&nbsp;X&nbsp;Y}&nbsp;{L&nbsp;set(value:<SPAN class="string">&quot;Clicked&nbsp;at&nbsp;&quot;</SPAN><SPAN class="keyword">#</SPAN>X<SPAN class="keyword">#</SPAN><SPAN class="string">&quot;,&quot;</SPAN><SPAN class="keyword">#</SPAN>Y)}&nbsp;<SPAN class="keyword">end</SPAN>)}<BR><SPAN class="keyword">end</SPAN>&nbsp;</CODE></BLOCKQUOTE><P></P><P>The <CODE>event</CODE> parameter is an atom describing the event you want to listen. Here <CODE>onclick</CODE> is the left mouse button being clicked. The <CODE>action</CODE> parameter can only take the procedure, method or port message forms. However these events can also receive parameters. The example above shows how the coordinates of the mouse are obtained. The parameters you want to received are specified by the <CODE>args</CODE> parameter. See the specific widget documentation to see valid codes. The action is called with as much parameters as specified with args. </P><P> </P></DIV><TABLE align="center" border="0" cellpadding="6" cellspacing="6" class="nav"><TR bgcolor="#DDDDDD"><TD><A href="node5.html#chapter.handle">&lt;&lt; Prev</A></TD><TD><A href="index.html">- Up -</A></TD><TD><A href="node7.html#chapter.browser">Next &gt;&gt;</A></TD></TR></TABLE><HR><ADDRESS>Donatien Grolaux<BR><SPAN class="version">Version 1.3.0 (20010902)</SPAN></ADDRESS></BODY></HTML>
